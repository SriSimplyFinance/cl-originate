[{"attributes":{"type":"skuid__Page__c","url":"/services/data/v42.0/sobjects/skuid__Page__c/a8n7a0000008r5RAAQ"},"Id":"a8n7a0000008r5RAAQ","Name":"Account_Address","skuid__API_Version__c":"v1","skuid__Type__c":"Desktop","skuid__UniqueId__c":"_Account_Address","skuid__Module__c":null,"skuid__Composer_Settings__c":"{\"skuid.model(GetAddressId)\":{\"search\":\"simply\"}}","skuid__MasterPage__c":null,"skuid__MasterPage__r":null,"skuid__IsMaster__c":false,"skuid__Layout__c":"<skuidpage unsavedchangeswarning=\"yes\" personalizationmode=\"server\" showsidebar=\"false\" showheader=\"false\">\n\t<models><model id=\"Account\" limit=\"1\" query=\"true\" createrowifnonefound=\"false\" datasource=\"salesforce\" sobject=\"Account\"><fields><field id=\"RecordTypeId\"/><field id=\"Search\" uionly=\"true\" displaytype=\"TEXT\" length=\"255\" label=\"Search\"/><field id=\"ShippingGeocodeAccuracy\"/><field id=\"ShippingAddress\" overridemetadata=\"false\" ogdisplaytype=\"ADDRESS\" displaytype=\"ADDRESS\" readonly=\"true\"/><field id=\"ShippingCity\"/><field id=\"ShippingCountry\"/><field id=\"ShippingState\"/><field id=\"ShippingLatitude\"/><field id=\"ShippingLongitude\"/><field id=\"ShippingPostalCode\"/><field id=\"ShippingStreet\"/><field id=\"BillingAddress\"/><field id=\"Registered_Address_Premises__c\"/><field id=\"Registered_Address_Road__c\"/><field id=\"BillingCountry\"/><field id=\"BillingState\"/><field id=\"BillingLatitude\"/><field id=\"BillingLongitude\"/><field id=\"BillingPostalCode\"/><field id=\"BillingStreet\"/><field id=\"BillingCity\"/><field id=\"Trading_Address_Premises__c\"/><field id=\"Trading_Address_Road__c\"/></fields><conditions><condition type=\"param\" value=\"id\" field=\"Id\" operator=\"=\" enclosevalueinquotes=\"true\"/></conditions><actions/></model><model id=\"GetAddressId\" query=\"false\" createrowifnonefound=\"false\" datasource=\"GetAddressId\" unloadwarningifunsavedchanges=\"false\" processonclient=\"true\" verb=\"GET\" payloadcontenttype=\"JSON\" endpoint=\"{{search}}?api-key=i0lhe7bHKEm45UU62lM6BQ30143&amp;all=true&amp;top=100&amp;expand=true\" pathtocontent=\"suggestions\" fieldtargetobjects=\"suggestions\"><fields><field id=\"address\" label=\"Address\" ispolymorphic=\"false\" isnamepointing=\"false\" displaytype=\"STRING\" accessible=\"true\" filterable=\"true\"/><field id=\"id\" label=\"Id\" ispolymorphic=\"false\" isnamepointing=\"false\" displaytype=\"STRING\" accessible=\"true\" filterable=\"true\"/><field id=\"url\" label=\"Url\" ispolymorphic=\"false\" isnamepointing=\"false\" displaytype=\"STRING\" accessible=\"true\" filterable=\"true\"/></fields><conditions><condition type=\"modelmerge\" value=\"\" sourcetype=\"param\" sourceparam=\"search\" operator=\"=\" model=\"Account\" enclosevalueinquotes=\"true\" mergefield=\"Search\" novaluebehavior=\"deactivate\"/></conditions><actions/><methods/><idfields><field>id</field></idfields></model><model id=\"FullAddresses\" query=\"true\" createrowifnonefound=\"false\" datasource=\"Ui-Only\" processonclient=\"true\"><fields><field displaytype=\"BOOLEAN\" length=\"255\" label=\"Added From GetAddress API\" id=\"AddedfromGetAddress\" defaultvaluetype=\"fieldvalue\" ogdisplaytype=\"TEXT\" defaultValue=\"false\"/><field id=\"Postcode\" displaytype=\"TEXT\" length=\"255\" label=\"Postcode\"/><field id=\"id\" displaytype=\"TEXT\" length=\"255\" label=\"id\"/><field id=\"recordid\" displaytype=\"UUID\" length=\"255\" ogdisplaytype=\"TEXT\" readonly=\"true\" label=\"recordid\"/><field id=\"Town/City\" displaytype=\"TEXT\" length=\"255\" label=\"Town/City\"/><field id=\"Country\" displaytype=\"TEXT\" length=\"255\" label=\"Country\"/><field id=\"County\" displaytype=\"TEXT\" length=\"255\" label=\"County\"/><field id=\"Line 1\" displaytype=\"TEXT\" length=\"255\" label=\"Line 1\"/><field id=\"Line 2\" displaytype=\"TEXT\" length=\"255\" label=\"Line 2\"/><field id=\"Address\" displaytype=\"FORMULA\" length=\"255\" label=\"Address\" ogdisplaytype=\"TEXT\" readonly=\"true\" returntype=\"TEXT\"><formula>JOIN_TEXT(\" \",{{Line 1}},{{Line 2}})</formula></field><field id=\"District\" displaytype=\"TEXT\" length=\"255\" label=\"District\"/><field id=\"ReturnedCounty\" displaytype=\"FORMULA\" length=\"255\" label=\"County\" ogdisplaytype=\"TEXT\" readonly=\"true\" returntype=\"TEXT\"><formula>IF(ISBLANK({{County}}),{{District}},{{County}})</formula></field><field displaytype=\"DOUBLE\" length=\"255\" id=\"Building Number\" label=\"Building Number\" ogdisplaytype=\"TEXT\" precision=\"9\" scale=\"0\"/><field id=\"Sub Building Number\" displaytype=\"DOUBLE\" length=\"255\" label=\"Sub Building Number\" ogdisplaytype=\"TEXT\" precision=\"9\" scale=\"0\"/><field displaytype=\"FORMULA\" length=\"255\" ogdisplaytype=\"TEXT\" readonly=\"true\" returntype=\"DOUBLE\" id=\"BuildingNumberSort\" label=\"BuildingNumberSort\" helptext=\"Used to sort FullAddresses by Building or Sub Building Number\" precision=\"9\" scale=\"0\"><formula>\n\nIF({{Building Number}} == '',{{Sub Building Number}},{{Building Number}})</formula></field></fields><conditions/><actions><action><actions><action type=\"sortModel\" client-side=\"true\" model=\"FullAddresses\" method=\"asc\" field=\"BuildingNumberSort\"/></actions><events><event>row.created</event></events></action></actions><idfields><field>recordid</field></idfields></model></models>\n\t<components><tabset rememberlastusertab=\"false\" defertabrendering=\"true\" uniqueid=\"sk-1erv-302\"><tabs><tab name=\"Address Information\" loadlazypanels=\"true\"><components><basicfieldeditor showheader=\"true\" showsavecancel=\"false\" showerrorsinline=\"true\" model=\"Account\" uniqueid=\"sk-1fcH-1360\" mode=\"read\"><columns><column width=\"50%\" uniqueid=\"sk-1fcH-1356\"><sections><section title=\"Section A\" uniqueid=\"sk-1fcH-1357\" collapsible=\"no\" showheader=\"false\"><fields><field uniqueid=\"sk-1fhO-2400\" type=\"COMBO\" editmodebehavior=\"custompopup\" redirecttype=\"none\"><label>Trading Address</label><template>{{ShippingStreet}}\n{{ShippingCity}}\n{{ShippingState}}\n{{ShippingPostalCode}}\n{{ShippingCountry}}</template><editmodepopup title=\" Address\" width=\"450\"><components><buttonset model=\"Account\" uniqueid=\"sk-1fhc-2510\"><buttons><button type=\"multi\" label=\"Save\" uniqueid=\"sk-1fhc-2515\" icon=\"sk-icon-mark-completed\"><actions><action type=\"updateRow\" fieldmodel=\"Account\" affectedrows=\"context\"><updates><update valuesource=\"fieldvalue\" field=\"ShippingStreet\" enclosevalueinquotes=\"true\" value=\"{{Trading_Address_Premises__c}}, {{Trading_Address_Road__c}}\"/></updates></action><action type=\"save\"><models><model>Account</model></models></action><action type=\"closeAllPopups\"/></actions></button></buttons></buttonset><basicfieldeditor showsavecancel=\"false\" mode=\"edit\" model=\"Account\" uniqueid=\"sk-1fhT-2486\"><columns><column width=\"100%\"><sections><section title=\"\" collapsible=\"no\"><fields><field uniqueid=\"sk-1fiB-2632\" id=\"Trading_Address_Premises__c\"/><field uniqueid=\"sk-1fiB-2631\" id=\"Trading_Address_Road__c\"/><field id=\"ShippingCity\" uniqueid=\"sk-1fhT-2475\"/><field id=\"ShippingState\" uniqueid=\"sk-1fhT-2478\"/><field id=\"ShippingPostalCode\" uniqueid=\"sk-1fhT-2481\"/><field id=\"ShippingCountry\" uniqueid=\"sk-1fhT-2484\"/></fields></section></sections></column></columns></basicfieldeditor></components></editmodepopup></field></fields></section></sections></column><column width=\"50%\" uniqueid=\"sk-2E7Q-507\"><sections><section title=\"New Section\" collapsible=\"no\" uniqueid=\"sk-2E7T-521\" showheader=\"false\"><fields><field uniqueid=\"sk-2E7L-405\" type=\"COMBO\" editmodebehavior=\"custompopup\"><label>Registered Address</label><template>{{BillingStreet}}\n{{BillingCity}}\n{{BillingState}}\n{{BillingPostalCode}}\n{{BillingCountry}}</template><editmodepopup title=\"Registered Address\" width=\"450\"><components><buttonset uniqueid=\"sk-2kx7-702\"><buttons><button type=\"multi\" label=\"Save\" uniqueid=\"sk-2kz3-958\" icon=\"sk-icon-case-close\"><actions><action type=\"updateRow\" fieldmodel=\"Account\" affectedrows=\"context\"><updates><update valuesource=\"fieldvalue\" field=\"BillingStreet\" enclosevalueinquotes=\"true\" value=\"{{Registered_Address_Premises__c}} {{Trading_Address_Road__c}}\"/></updates></action><action type=\"save\"><models><model>Account</model></models></action><action type=\"closeAllPopups\"/></actions></button></buttons></buttonset><basicfieldeditor showsavecancel=\"false\" mode=\"edit\" model=\"Account\" uniqueid=\"sk-2kvG-553\"><columns><column width=\"100%\"><sections><section title=\"\" collapsible=\"no\"><fields><field uniqueid=\"sk-2kvL-576\" id=\"Registered_Address_Premises__c\"/><field uniqueid=\"sk-2kvL-577\" id=\"Registered_Address_Road__c\"/><field id=\"BillingCity\" uniqueid=\"sk-2kvG-542\"/><field id=\"BillingState\" uniqueid=\"sk-2kvG-545\"/><field id=\"BillingPostalCode\" uniqueid=\"sk-2kvG-548\"/><field id=\"BillingCountry\" uniqueid=\"sk-2kvG-551\"/></fields></section></sections></column></columns></basicfieldeditor></components></editmodepopup></field></fields></section></sections></column></columns></basicfieldeditor></components><oninitialshowactions/><onshowactions/></tab><tab name=\"Address Search\"><components><basicfieldeditor showheader=\"true\" showsavecancel=\"false\" showerrorsinline=\"true\" model=\"Account\" uniqueid=\"sk-1f6X-400\" mode=\"edit\"><columns><column width=\"100%\" uniqueid=\"sk-1f6X-396\"><sections><section title=\"New Section\" collapsible=\"no\" uniqueid=\"sk-1f6b-424\" showheader=\"false\"><fields><field uniqueid=\"sk-1f6d-442\" id=\"Search\"/><field uniqueid=\"sk-1f6p-517\" type=\"BUTTON\" icon=\"sk-icon-search\"><text>Search</text><actions><action type=\"emptyModelData\"><models><model>FullAddresses</model></models></action><action type=\"requeryModel\" model=\"GetAddressId\" behavior=\"standard\"/><action type=\"save\"><models><model>GetAddressId</model></models></action><action type=\"custom\" snippet=\"newSnippet\"/><action type=\"blockUI\" timeout=\"5000\" message=\"Please Wait, Address is being searched....\"/></actions><renderconditions logictype=\"and\" onhidedatabehavior=\"keep\"/><enableconditions/></field></fields></section></sections></column></columns><renderconditions logictype=\"and\"/></basicfieldeditor><skootable showconditions=\"true\" showsavecancel=\"false\" showerrorsinline=\"true\" searchmethod=\"client\" searchbox=\"true\" showexportbuttons=\"false\" hideheader=\"false\" hidefooter=\"false\" pagesize=\"all\" alwaysresetpagination=\"true\" createrecords=\"false\" model=\"FullAddresses\" mode=\"readonly\" allowcolumnreordering=\"true\" responsive=\"false\" uniqueid=\"sk-1fVC-496\" searchplaceholdertext=\"Filter Address\" instantfilters=\"false\" allowscrollbars=\"false\" sortonclient=\"false\"><fields><field id=\"Line 1\" hideable=\"true\" uniqueid=\"fi-1fVY-574\"/><field id=\"Line 2\" hideable=\"true\" uniqueid=\"fi-1fVY-575\"><label>Street</label></field><field id=\"Postcode\" hideable=\"true\" uniqueid=\"fi-1fVY-576\"/><field id=\"ReturnedCounty\" hideable=\"true\" uniqueid=\"fi-1fVY-577\"/><field id=\"Town/City\" hideable=\"true\" uniqueid=\"fi-1fVY-578\"/><field id=\"Country\" hideable=\"true\" uniqueid=\"fi-1fVY-579\"/><field type=\"BUTTON\" hideable=\"false\" uniqueid=\"fi-1fVe-596\" showbydefault=\"true\"><text>Add to Trading Address</text><actions><action type=\"updateRow\" fieldmodel=\"Account\" affectedrows=\"context\"><updates><update valuesource=\"fieldvalue\" field=\"ShippingPostalCode\" enclosevalueinquotes=\"true\" value=\"{{Postcode}}\"/><update valuesource=\"fieldvalue\" field=\"ShippingStreet\" enclosevalueinquotes=\"true\" value=\"{{Address}}\"/><update valuesource=\"fieldvalue\" value=\"{{ReturnedCounty}}\" field=\"ShippingState\" enclosevalueinquotes=\"true\"/><update valuesource=\"fieldvalue\" field=\"ShippingCountry\" enclosevalueinquotes=\"true\" value=\"{{Country}}\"/><update valuesource=\"fieldvalue\" field=\"ShippingCity\" enclosevalueinquotes=\"true\" value=\"{{Town/City}}\"/><update valuesource=\"fieldvalue\" field=\"Trading_Address_Road__c\" enclosevalueinquotes=\"true\" value=\"{{Line 2}}\"/><update valuesource=\"fieldvalue\" field=\"Trading_Address_Premises__c\" enclosevalueinquotes=\"true\" value=\"{{Line 1}}\"/></updates></action><action type=\"save\"><models><model>Account</model></models></action><action type=\"blockUI\" message=\"Updating...\" timeout=\"2000\"/></actions></field><field type=\"BUTTON\" hideable=\"true\" uniqueid=\"fi-3IaI-473\"><text>Add to Registered Address</text><actions><action type=\"updateRow\" fieldmodel=\"Account\" affectedrows=\"context\"><updates><update valuesource=\"fieldvalue\" field=\"BillingStreet\" enclosevalueinquotes=\"true\" value=\"{{Line 1}} {{Line 2}}\"/><update valuesource=\"fieldvalue\" field=\"BillingPostalCode\" enclosevalueinquotes=\"true\" value=\"{{Postcode}}\"/><update valuesource=\"fieldvalue\" value=\"{{ReturnedCounty}}\" field=\"BillingState\" enclosevalueinquotes=\"true\"/><update valuesource=\"fieldvalue\" field=\"BillingCountry\" enclosevalueinquotes=\"true\" value=\"{{Country}}\"/><update valuesource=\"fieldvalue\" field=\"BillingCity\" enclosevalueinquotes=\"true\" value=\"{{Town/City}}\"/><update valuesource=\"fieldvalue\" field=\"Registered_Address_Premises__c\" enclosevalueinquotes=\"true\" value=\"{{Line 1}}\"/><update valuesource=\"fieldvalue\" field=\"Registered_Address_Road__c\" enclosevalueinquotes=\"true\" value=\"{{Line 2}}\"/></updates></action><action type=\"save\"><models><model>Account</model></models></action><action type=\"blockUI\" message=\"Updating...\" timeout=\"2000\"/></actions></field></fields><rowactions/><massactions usefirstitemasdefault=\"true\"/><views><view type=\"standard\"/></views><searchfields/><renderconditions logictype=\"and\"/></skootable></components><oninitialshowactions/><onshowactions/></tab></tabs></tabset></components>\n\t<resources>\n\t\t<labels/>\n\t\t<javascript><jsitem location=\"inlinesnippet\" name=\"newSnippet\" cachelocation=\"false\">var params = arguments[0],\n\t$ = skuid.$;\n\t\n\n// var GetAddress = skuid.model.getModel('GetAddressId');\n// var GetAddressRow = [];\n// GetAddressRow = GetAddress.data;\n\n// var FullAddress = skuid.model.getModel('GetFullAddress');\n// var FullAddressRow = [];\n// FullAddressRow = FullAddress.data;\n\n\nvar GetAddress = skuid.model.map().GetAddressId;\n//var FullAddress = model.FullAddresses;\n\n/*\nvar model = skuid.model.map().GetFullAddress;\nvar GetAddress = skuid.model.map().GetAddressId;\n//var GetAddress = models.GetAddressId;\n//var FullAddress = models.FullAddresses;\n\n\n$.each(GetAddress.data,function(){\n    var newRowId = this.id;\nmodel.setCondition(model.getConditionByName('id'),newRowId);\n\n });\n*/\n/*\n$.each(GetAddress.data,function(){\n      var newRowId = this.url;\n      \n$.getJSON('https://api.getAddress.io'+newRowId+'?api-key=i0lhe7bHKEm45UU62lM6BQ30143', function(data) {\n          var postcode = data.postcode;\n          alert(postcode);\n          test(data);\n    // JSON result in `data` variable\n});\n\n\n\n\n      \n});\n\n\nfunction test(data){\n    alert('has worked');\n\n}\n*/\n$.each(GetAddress.data,function(){\n    \n    let newRowUrl = this.url;\n    let newRowId = this.id;\n    \n function getJson (response) {\n    \n   return response.json();\n  \n }\n\nPromise.all([\n  fetch('https://api.getAddress.io'+newRowUrl+'?api-key=i0lhe7bHKEm45UU62lM6BQ30143').then(getJson)\n]).then(function (results) {\n  var values = results[0];\n  //alert('Done');\n  var FullAddress = skuid.model.map().FullAddresses;\n  if (values.length !== 0) {\n    // Do stuff\n   // alert(values.postcode);\n    \n  \n     var row = FullAddress.createRow({doAppend:true,additionalConditions:[\n           {field: 'id', value: newRowId},\n           {field: 'Postcode', value: values.postcode},\n           {field: 'Line 1', value: values.line_1},\n           {field: 'Line 2', value: values.line_2},\n           {field: 'County', value: values.county},\n           {field: 'District', value: values.district},\n           {field: 'Town/City', value: values.town_or_city},\n           {field: 'Country', value: values.country},\n           {field: 'Building Number', value: values.building_number},\n           {field: 'Sub Building Number', value: values.sub_building_number}\n        ]});\n  setTimeout(function(){ FullAddress.save(); }, 3000);\n  \n \n    // alert('test');\n    console.log('Done');\n  }\n\n\n \n}).catch(function () {\n  console.log('Error');\n});\n});\n\n\n</jsitem><jsitem location=\"staticresource\" name=\"CLSNGUIComponent\" cachelocation=\"false\" url=\"\" namespace=\"genesisExtn\" content_type=\"application/zip\">var params = arguments[0],\n\t$ = skuid.$;\n</jsitem><jsitem location=\"staticresource\" name=\"CLSNGUIComponent\" cachelocation=\"false\" url=\"\" namespace=\"genesisExtn\" content_type=\"application/zip\">var params = arguments[0],\n\t$ = skuid.$;\n</jsitem><jsitem location=\"staticresource\" name=\"CLSNGUIComponent\" cachelocation=\"false\" url=\"\" namespace=\"genesisExtn\" content_type=\"application/zip\">var params = arguments[0],\n\t$ = skuid.$;\n</jsitem></javascript>\n\t\t<css><cssitem location=\"staticresource\" name=\"CLSStyleSheetPack\" cachelocation=\"false\" url=\"\" namespace=\"genesisExtn\" content_type=\"application/zip\"/></css>\n\t\t<actionsequences uniqueid=\"sk-1esO-344\"/>\n\t</resources>\n\t<styles>\n\t\t<styleitem type=\"background\" bgtype=\"none\"/>\n\t</styles>\n</skuidpage>","skuid__Layout2__c":null,"skuid__Layout3__c":null,"skuid__Layout4__c":null,"skuid__Layout5__c":null}]